# ArtsofteTestTask

## Локальный запуск

`npm run dev` для запуска сервера на локалхосте. Доступен по адресу `http://localhost:8080/`.

## Сборка

`npm run build` для сборки проекта. Собранное приложение будет в папке `dist/`. Сборка происходит с помощью webpack. Настройки находятся в файле `webpack.config.js`

## Размещение в сети

Любое изменение `master` ветки на гитхабе влечет за собой деплой в heroku. На heroku сервис собирается в директорию `dist/` и размещается по адресу `https://artsofte-test-task.herokuapp.com/`

## Краткое описание

Проект редоставляет из себя сервис, с помощью которого можно переводить деньги с одной банковской карты на другую и посмотреть историю переводов. Сервис разработан с помощью фреймворка `Angular 7` и представлен в виде SPA.

## Как пользоваться сервисом

* При открытии главной страницы, можно заметить меню, состоящее из двух кнопок "Создать платеж" и "История платежей". По умолчанию, при запуске, первым открывается блок создания платежа. Весь блок состоит из формы с полями для корректного перевода и кнопки перевода, представленной в виде стрелки между картами.

  ![](https://i.imgur.com/ZWOSlmg.png)

* Чтобы сделать перевод, нужно корректно заполнить все поля формы:
  * Ввести 16 чисел в поля ввода номера карты получателя и отправителя (номера должны быть разными);
  * Ввести через пробел имя и фамилию отправителя (как указано на карте);
  * Выбрать срок действия карты с помощью селекта (он должен быть больше чем текущая дата);
  * Ввести сумму (от 100 до 1000000), если будет введено больше или меньше, то подставится ближнее значение.

  После корректного заполнения, кнопка в центре станет крупнее, ярче и будет возможность на нее нажать, чтобы совершить перевод.

  ![](https://i.imgur.com/iFNmOsV.png)

* При возникновении ошибки на экране появится сообщение об ошибке. При успешном совершении операции, появится соответсвующее уведомлением, а данные о переводе появятся в истории.

  ![](https://i.imgur.com/17WLvZm.png)

* Открыть историю можно, нажав по вкладке "История платежей". Перед пользователем октроется список переводов от нового к старому.

  ![](https://i.imgur.com/JDfBtiR.png)

* Чтобы повторить операцию, можно нажать на соответсвующую кнопку, все реквизиты будут находится во вкладке "Создать платеж", их можно будет увидеть после перехода в него.

  ![](https://i.imgur.com/ZufmI8J.gif)

* Чтобы удалить операция, можно нажать на соответсвующую кнопку.

  ![](https://i.imgur.com/nK06cGM.gif)


## Архитектура

Весь сервис состоит из одного модуля (`app/app.module.ts`), в которм содержатся 4 компоненты и 1 сервис:

#### Компоненты:

* `LayoutComponent` содержит логику работы переключения между другими компонентами. Зависит от сервиса `ComponentFactoryResolver`, который предоставляет возможность динамически генерировать дочерние компоненты.
  * `PaymentCreateComponent` содержит логику работы блока с формой перевода. Зависит от сервиса `StorageWorkerService`, используя его методы и подписываясь на его события. Является дочерним компонентом у `LayoutComponent`.
  * `HistoryComponent` содержит логику работы блока с историей переводов. Зависит от сервиса `StorageWorkerService`, используя его методы и подписываясь на его события. Является дочерним компонентом у `LayoutComponent`.
* `AppComponent` инициализирующий компонент, инициирует отрисовку других компонентов.

### Сервис:

В приложении реализована одна сущность типа сервис - `StorageWorkerService`. Сервис содержит основную логику работы приложения по работе с LocalStorage. Является в каком-то роде мидлварой между компонентами и сервисом `localStorageService`. Имеет возможность добавлять в localstorage браузер данные (метод `pushRecordToLocalStorage`), удалять их (метод `deleteRecordFromLocalStorage`). Умеет реагировать на изменения localstorage браузера и прокидывать это событие в компоненты сервиса (методы `localStorageChanged` и `emitStorageChangedEvent`). А так же может возбудить событие того, что нужно повторить платеж и прокидывает соответсвющие данные о нем в другую компоненту(методы `repeatPay` и `emitRepeatPayEvent`).
